package PersonalFinanceManagerWeek2;import javax.swing.*;import java.awt.*;import java.awt.event.*;import java.sql.*; // Import for Database operations// Class to set a new financial goalpublic class SetGoals extends JFrame implements ActionListener {        // Components for goal setting    private Choice cGoalType;    private JTextField tfTargetAmount, tfStartingBalance, tfDeadline;    private JButton save, clear, back;    private String username;    // Define Dark Theme Colors    private static final Color BG_DARK = new Color(25, 25, 25);    private static final Color PANEL_DARK = new Color(40, 40, 40);    private static final Color TEXT_LIGHT = Color.WHITE;    private static final Color ACCENT_GREEN = new Color(0, 180, 0); // Save Button    private static final Color ACCENT_BLUE = new Color(30, 100, 255); // Clear Button    private static final Color FIELD_BG = new Color(50, 50, 50);    SetGoals(String username) {        this.username = username;        // --- Frame Setup ---        setTitle("SET NEW FINANCIAL GOAL");        setBounds(500, 200, 700, 480);        setLocationRelativeTo(null);        getContentPane().setBackground(BG_DARK);        setLayout(null);         // --- Heading ---        JLabel text = new JLabel("DEFINE YOUR SAVINGS GOAL");        text.setFont(new Font("Tahoma", Font.BOLD, 22));        text.setForeground(ACCENT_GREEN);        text.setBounds(70, 20, 400, 30);        add(text);        // --- Goal Input Fields (GUI Unchanged) ---        int labelX = 100;        int valueX = 350;        int yStart = 80;        int ySpacing = 40;                // 1. User Account (Display only)        JLabel lblUsername = createLabel("User Account", labelX, yStart);        add(lblUsername);                JLabel labelUsername = createValueLabel(username, valueX, yStart);        add(labelUsername);        yStart += ySpacing;                // 2. Goal Type        JLabel lblGoalType = createLabel("Goal Type / Name", labelX, yStart);        add(lblGoalType);                cGoalType = new Choice();        cGoalType.add("Emergency Fund");        cGoalType.add("Dream Vacation");        cGoalType.add("House Down Payment");        cGoalType.add("Investment Capital");        cGoalType.setBounds(valueX, yStart, 200, 25);        cGoalType.setBackground(FIELD_BG);        cGoalType.setForeground(TEXT_LIGHT);        add(cGoalType);        yStart += ySpacing;        // 3. Target Amount        JLabel lblTargetAmount = createLabel("Target Amount (Rs)", labelX, yStart);        add(lblTargetAmount);                tfTargetAmount = createTextField("0.00", valueX, yStart);        add(tfTargetAmount);        yStart += ySpacing;        // 4. Starting Balance        JLabel lblStartingBalance = createLabel("Current/Starting Balance (Rs)", labelX, yStart);        add(lblStartingBalance);                tfStartingBalance = createTextField("0.00", valueX, yStart);        add(tfStartingBalance);        yStart += ySpacing;                // 5. Deadline        JLabel lblDeadline = createLabel("Target Deadline (Months)", labelX, yStart);        add(lblDeadline);                tfDeadline = createTextField("12", valueX, yStart);        add(tfDeadline);        yStart += ySpacing + 30;        // --- Buttons ---        int buttonXStart = 100;        int btnWidth = 140;        int btnGap = 20;        save = new JButton("Save Goal");        save.setBackground(ACCENT_GREEN);        save.setForeground(TEXT_LIGHT);        save.setBounds(buttonXStart, yStart, btnWidth, 35);        save.addActionListener(this);        add(save);                clear = new JButton("Clear Fields");        clear.setBackground(ACCENT_BLUE);        clear.setForeground(TEXT_LIGHT);        clear.setBounds(buttonXStart + btnWidth + btnGap, yStart, btnWidth, 35);        clear.addActionListener(this);        add(clear);        back = new JButton("Back");        back.setBackground(Color.DARK_GRAY);        back.setForeground(TEXT_LIGHT);        back.setBounds(buttonXStart + 2 * (btnWidth + btnGap), yStart, btnWidth - 40, 35);        back.addActionListener(this);        add(back);                setVisible(true);    }        // --- Helper Methods (Unchanged) ---    private JLabel createLabel(String text, int x, int y) {        JLabel label = new JLabel(text);        label.setFont(new Font("Tahoma", Font.PLAIN, 16));        label.setBounds(x, y, 250, 25);        label.setForeground(TEXT_LIGHT);        return label;    }    private JLabel createValueLabel(String text, int x, int y) {        JLabel label = new JLabel(text);        label.setFont(new Font("Tahoma", Font.BOLD, 16));        label.setBounds(x, y, 200, 25);        label.setForeground(TEXT_LIGHT);        return label;    }        private JTextField createTextField(String defaultText, int x, int y) {        JTextField tf = new JTextField(defaultText);        tf.setBounds(x, y, 200, 25);        tf.setBackground(FIELD_BG);        tf.setForeground(ACCENT_GREEN);        tf.setCaretColor(TEXT_LIGHT);        return tf;    }    // --- Action Listener (DB Insertion Logic Added) ---    public void actionPerformed(ActionEvent ae) {        if (ae.getSource() == save) {            String goalName = cGoalType.getSelectedItem();            String targetStr = tfTargetAmount.getText().replace(",", "");            String startStr = tfStartingBalance.getText().replace(",", "");            String deadlineStr = tfDeadline.getText();            try {                double target = Double.parseDouble(targetStr);                double start = Double.parseDouble(startStr);                int deadline = Integer.parseInt(deadlineStr);                                // 1. Validation Checks                if (target <= start) {                    JOptionPane.showMessageDialog(this, "Target Amount must be greater than Current/Starting Balance.", "Input Error", JOptionPane.ERROR_MESSAGE);                    return;                }                if (deadline <= 0) {                    JOptionPane.showMessageDialog(this, "Deadline must be a positive number of months.", "Input Error", JOptionPane.ERROR_MESSAGE);                    return;                }                // 2. Database Insertion                Conn c = new Conn();                                // Check if a goal with the same name already exists for the user                String checkQuery = "SELECT * FROM goals WHERE username = '"+username+"' AND goal_name = '"+goalName+"'";                ResultSet rs = c.s.executeQuery(checkQuery);                if (rs.next()) {                    // Goal exists, prompt to update                    int confirm = JOptionPane.showConfirmDialog(this, "Goal '" + goalName + "' already exists. Do you want to UPDATE the target and deadline?", "Confirm Update", JOptionPane.YES_NO_OPTION);                                        if (confirm == JOptionPane.YES_OPTION) {                         String updateQuery = "UPDATE goals SET target_amount = "+target+", starting_balance = "+start+", deadline_months = "+deadline+" WHERE username = '"+username+"' AND goal_name = '"+goalName+"'";                         c.s.executeUpdate(updateQuery);                         JOptionPane.showMessageDialog(null, "Goal '"+goalName+"' UPDATED successfully!");                    } else {                        return; // Cancelled update                    }                } else {                    // Goal does not exist, insert new                    String insertQuery = "INSERT INTO goals (username, goal_name, target_amount, starting_balance, deadline_months, current_saved) " +                                         "VALUES ('"+username+"', '"+goalName+"', "+target+", "+start+", "+deadline+", "+start+")";                    c.s.executeUpdate(insertQuery);                    JOptionPane.showMessageDialog(null, "New Goal '"+goalName+"' saved successfully!");                }                                setVisible(false);                dispose();                            } catch (NumberFormatException e) {                JOptionPane.showMessageDialog(this, "Please enter valid numbers for amounts and deadline.", "Input Error", JOptionPane.ERROR_MESSAGE);            } catch (SQLException e) {                e.printStackTrace();                JOptionPane.showMessageDialog(null, "Database Error: Could not save goal: " + e.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);            }                    } else if (ae.getSource() == clear) {            cGoalType.select(0);            tfTargetAmount.setText("0.00");            tfStartingBalance.setText("0.00");            tfDeadline.setText("12");        } else if (ae.getSource() == back) {            setVisible(false);            dispose();        }    }        public static void main(String[] args) {        new SetGoals("sarmad");    }}